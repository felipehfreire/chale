<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough">

<ui:composition template="template.xhtml">

	<ui:define name="content">
		
			<div class="page-header"></div>
			<div class="row container-center">
				<div class="col-lg-6 div-center">
					<div class="well">
						<div class="form-group">
							<h:form id="submitForm" class="bs-example form-horizontal">		
							<h:outputLabel value="Cód. Produto" class="col-lg-2 control-label" for="codProd" />
							<div class="col-lg-1">
								<h:inputText class="form-control" name="codProd" id="codProd" value="#{pedidoController.idProd}" converter="javax.faces.Long">
									<f:ajax listener="#{pedidoController.reRenderProduto}" render="prods" />
								</h:inputText>
							</div>
							
							<h:outputLabel value="Produtos" class="col-lg-2 control-label" for="prods" />
							<div class="col-lg-3">
								<h:selectOneMenu id="prods" label="prods"   styleClass="form-control"
						             	value="#{pedidoController.pedidoProduto.produto}"
						                converter="simpleEntityConverter" required="true" >
						                <f:selectItem itemValue="" itemLabel="Selecione um Produto"/>  
						                <f:selectItems value="#{pedidoController.produtosSelect}" 
						                	var="prod" 
						                	itemLabel="#{prod.descricao}" 
						                	itemValue="#{prod}"/>
						                <f:ajax listener="#{pedidoController.reRenderIdProduto}" render="codProd" event="change" /> 
						            </h:selectOneMenu>
						      </div>
						      
						     <h:outputLabel value="Quantidade" class="col-lg-2 control-label" for="qtdProd" />
				             <div class="col-lg-1">
				             	<h:inputText class="form-control" name="qtdProd" id="qtdProd" value="#{pedidoController.pedidoProduto.quantidade}"
							    		converter="javax.faces.Long"  />
				             </div> 
							
							<p:commandButton id="btn_add" value="Add" ajax="false"
                           	  		action="#{pedidoController.add}" >  
       						  </p:commandButton> 
    						 </h:form>
    						 <p:spacer width="20" height="20" /> 
    						 <h:form id="submitForm2" class="bs-example form-horizontal">
       						  <div class="well">
       						     <p:outputPanel id="pedidos">
       						     	<p:dataTable  value="#{pedidoController.pedido.pedidosProdutos}" var="pedProdIn" sortMode="multiple" rows="10"  paginator="true">
								
									<p:column sortBy="#{pedProdIn.produto.id}" headerText="Código">
										<h:outputText value="#{pedProdIn.produto.id}"/>
									</p:column>
									
									<p:column  sortBy="#{pedProdIn.produto.descricao}" headerText="Produto">
										<h:outputText value="#{pedProdIn.produto.descricao}"/>
									</p:column>
									
									<p:column sortBy="#{pedProdIn.quantidade}" headerText="Quantidade">
										<h:outputText value="#{pedProdIn.quantidade}"/>
									</p:column>
									
									<p:column headerText="Editar">
										<h:commandButton class="btn btn-primary" ajax="false" value="Editar" action="#{produtoController.editar}">
										<f:setPropertyActionListener value="#{pedProdIn}"
		                        			target="#{pedidoController.pedidoProduto}" />
		                    		</h:commandButton>
									</p:column>
									
								</p:dataTable>
       						     </p:outputPanel>  
       						  </div>
       						  
       						  
       						  	 <h:outputLabel value="Data" class="col-lg-2 control-label" for="data" />
       						  	 <div class="col-lg-2">
									<h:inputText class="form-control" name="data" id="data" 
										value="#{pedidoController.pedido.dataVenda}" 
										mask="99/99/9999"  converter="javax.faces.DateTime" readonly="true" />
       						 	 </div>
       						 	 
       						 	 <h:outputLabel value="À prazo" class="col-lg-1 control-label" for="aPrazo" />
       						 	 <div class="col-lg-2">
       						 	 	<h:selectBooleanCheckbox class="form-control" name="aPrazo" id="aPrazo" 
       						 	 		value="#{pedidoController.pedido.vendaPrazo}" />
        						 </div>
        						 
        						 <h:outputLabel value="Mesa" class="col-lg-2 control-label" for="mesa" />
								 <div class="col-lg-2">
								 	<h:selectOneMenu id="mesa" label="mesas" required="true" requiredMessage="Selecione uma mesa" styleClass="form-control"
						             	value="#{pedidoController.pedido.mesa}" 
						                converter="simpleEntityConverter"> 
						                <f:selectItem itemValue="" itemLabel="Selecione uma Mesa"/>  
						                <f:selectItems value="#{pedidoController.mesas}" 
						                	var="mesa" 
						                	itemLabel="#{mesa.numeroMesa}" 
						                	itemValue="#{mesa}"/>  
						            </h:selectOneMenu>
								 </div>
								 
								 <div class="col-lg-2">
									<p:commandButton value="Finalizar" styleClass="btn btn-primary" ajax="true" onclick="confirmation.show()"/>
									
								 </div>
								
								 </h:form>
								 <h:form id="dlg">  
                      				<p:confirmDialog  message="Deseja realmente finalizar o pedido?" hideEffect="explode" header="Aviso" severity="alert" widgetVar="confirmation">  
                          				<p:commandButton id="btnSim" value="Sim" ajax="false" action="#{pedidoController.finalizar}" process="@form"/>  
                          				<p:commandButton id="btnNao" value="Não" ajax="false"/>  
                      				</p:confirmDialog>  
								</h:form>  
							
						</div>
					</div>
				</div>
			</div>
		
	</ui:define>
</ui:composition>
</html>